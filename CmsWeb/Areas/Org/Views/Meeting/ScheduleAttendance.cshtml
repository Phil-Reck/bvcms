@using CmsData
@{
    ViewBag.Title = "Take Attendance";
    ViewBag.PageHeader = "Take Attendance";
    Layout = "~/Views/Shared/_AttendanceLayout.cshtml";
    var meeting = ViewBag.Meeting as Meeting;
    var meetingExists = meeting != null;
    var didNotMeet = meeting?.DidNotMeet == true;
    var takeAttendanceButton = didNotMeet ? "btn-default" : "btn-primary";
    var didNotMeetButton = didNotMeet ? "btn-danger" : "btn-default";
    var didNotMeetEnabled = ViewExtensions2.CurrentDatabase.Setting("UseDidNotMeetOption");
}
@helper AreYouSure(bool meetingExists)
{
    if (meetingExists)
    {
        WriteLiteral("onclick=\"return confirm('This meeting has already been recorded. Are you sure you want to continue?')\"");
    }
}
<div class="box-responsive">
    <div class="box-content col-md-6 col-md-offset-3">
        <div class="well">
            <div class="row">
                <div class="col-md-12">
                    @if (ViewBag.Error == null)
                    {
                        <form action="/Meeting/ScheduleAttendance" method="post">
                            @Html.Hidden("orgId", (int)ViewBag.OrgId)
                            @Html.Hidden("timestamp", (int)ViewBag.timestamp)
                            <div class="row">
                                @if (didNotMeetEnabled)
                                {
                                    <div class="col-sm-6">
                                        <button type="submit" name="TakeAttendance" class="btn btn-lg btn-block @takeAttendanceButton" @AreYouSure(meetingExists && didNotMeet)>Take attendance</button>
                                    </div>
                                    <div class="col-sm-6">
                                        <button type="submit" name="DidNotMeet" value="true" class="btn btn-lg btn-block @didNotMeetButton" @AreYouSure(meetingExists)>Did not meet</button>
                                    </div>
                                }
                                else
                                {
                                    <div class="col-sm-6 col-sm-offset-3">
                                        <button type="submit" name="TakeAttendance" class="btn btn-lg btn-block @takeAttendanceButton">Take attendance</button>
                                    </div>
                                }
                            </div>
                        </form>
                    }
                    else
                    {
                        <div class="alert alert-danger">
                            <p>
                                @ViewBag.Error
                            </p>
                        </div>
                    }
                </div>
            </div>
        </div>
    </div>
</div>
@ViewExtensions2.GoogleAnalytics()
@ViewExtensions2.jQuery()
@ViewExtensions2.Bootstrap3()
@Fingerprint.Script("/Content/touchpoint/js/app.min.js")
